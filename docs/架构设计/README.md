# 架构设计文档

> 本目录包含 PrismaX 项目的系统架构设计文档

---

## 文档索引

| 文档 | 说明 |
|------|------|
| [系统架构.md](./系统架构.md) | 整体系统架构设计 |
| [数据库设计.md](./数据库设计.md) | 数据库 Schema 设计 |
| [API设计.md](./API设计.md) | API 接口设计 |
| [消息流设计.md](./消息流设计.md) | 消息处理流程设计 |
| [插件系统设计.md](./插件系统设计.md) | 插件系统架构设计 |
| [Agent架构设计.md](./Agent架构设计.md) | Agent 系统架构设计 |
| [安全设计.md](./安全设计.md) | 安全架构设计 |
| [跨平台适配设计.md](./跨平台适配设计.md) | Web/Desktop 跨平台适配 |

---

## 架构概览

PrismaX 采用 **Monorepo + 多端共享** 架构，实现桌面版和 Web 版的代码最大化复用。

```
+-------------------------------------------------------------------------+
|                           PrismaX 架构总览                               |
+-------------------------------------------------------------------------+
|                                                                         |
|                        +---------------------+                          |
|                        |      用户界面        |                          |
|                        |   (React 组件层)     |                          |
|                        +----------+----------+                          |
|                                   |                                     |
|                        +----------v----------+                          |
|                        |     状态管理层       |                          |
|                        |     (Zustand)       |                          |
|                        +----------+----------+                          |
|                                   |                                     |
|                        +----------v----------+                          |
|                        |    核心业务逻辑层    |                          |
|                        |   (packages/core)   |                          |
|                        +----------+----------+                          |
|                                   |                                     |
|              +--------------------+--------------------+                |
|              |                    |                    |                |
|   +----------v----------+ +-------v------+ +----------v----------+      |
|   |    桌面版适配层      | |  AI SDK 层  | |    Web版适配层       |      |
|   |   (Electron IPC)    | | (providers) | |   (tRPC + API)      |      |
|   +----------+----------+ +------+------+ +----------+----------+      |
|              |                   |                   |                  |
|   +----------v----------+        |        +----------v----------+      |
|   |   本地存储层         |        |        |   服务端存储层       |      |
|   | - SQLite            |        |        | - PostgreSQL        |      |
|   | - 本地文件系统       |        |        | - Redis             |      |
|   +---------------------+        |        | - 本地/S3 文件      |      |
|                                  |        +---------------------+      |
|                                  v                                      |
|                        +---------------------+                          |
|                        |    AI 模型服务       |                          |
|                        | OpenAI/Claude/本地  |                          |
|                        +---------------------+                          |
|                                                                         |
+-------------------------------------------------------------------------+
```

---

## 设计原则

1. **代码复用** - 最大化共享代码，减少重复
2. **关注点分离** - 各层职责清晰，便于维护
3. **类型安全** - 全链路 TypeScript，端到端类型安全
4. **可扩展性** - 插件化设计，便于扩展
5. **性能优先** - 流式响应，懒加载，缓存优化
