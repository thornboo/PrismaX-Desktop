# 开发路线图

> 本文档描述 PrismaX-Desktop 版本规划和开发里程碑

---

## 当前开发进度（持续更新）

最后更新：2026-01-13

### 已完成（知识库底座）

- [x] 数据目录可配置/可迁移：支持搬迁、导入导出、重置（设置页 Data Settings）
- [x] 知识库：每 KB 一个目录（`knowledge-bases/<kbId>`）+ `meta.sqlite`（内置 migrations）
- [x] 任务系统：导入任务（暂停/继续/取消）、崩溃恢复、同 KB 串行队列
- [x] 全文检索：SQLite FTS5（chunks_fts + trigger 自动同步）
- [x] 大容量导入：blobs 采用 sha256 内容寻址去重 + 引用计数 + 增量指纹（source_path/mtime/size）
- [x] 文档管理：KB 内文档列表/删除（级联清理索引与 blobs 引用计数）
- [x] 向量索引：LanceDB（本地目录 `index/vector/lancedb/`）
- [x] 语义检索：`build_vectors` 任务 + 向量查询 API + 知识库页面 UI

### 下一步（仍在知识库阶段）

- [ ] RAG 闭环：聊天可选择知识库，混合检索（FTS + 向量）组装上下文并展示引用来源

### 后续（按顺序：插件体系 → MCP）

- [ ] 插件体系：manifest/权限/隔离运行时/Host API（禁止插件直连 DB 与数据目录）
- [ ] MCP：客户端进程管理（stdio transport）、权限、与插件/市场的安装与编排

---

## 版本概览

```
v0.1.0 (MVP)        v0.2.0              v0.3.0              v1.0.0
────────────────────────────────────────────────────────────────────►
   │                   │                   │                   │
   │ 基础聊天          │ 知识库 RAG        │ Agent 系统        │ 正式发布
   │ 多模型支持        │ 文档上传/解析     │ 工具调用          │ 插件市场
   │ 会话管理          │ 向量搜索          │ MCP 协议          │ 性能优化
   │ 本地存储          │ 上下文增强        │ 内置工具          │
   │                   │                   │ 插件系统          │
   └─ 4-6 周           └─ 4-6 周           └─ 6-8 周           └─ 持续迭代
```

---

## v0.1.0 - MVP

**目标：** 一个功能完整的桌面端 AI 聊天应用

**预计周期：** 4-6 周

### 功能范围

| 功能          | 优先级 | 描述                         |
| ------------- | ------ | ---------------------------- |
| 基础聊天      | P0     | 单轮/多轮对话，流式响应      |
| 多模型支持    | P0     | OpenAI、Claude、Ollama       |
| 会话管理      | P0     | 创建、删除、重命名、历史记录 |
| 本地存储      | P0     | SQLite 存储会话和消息        |
| API Key 管理  | P0     | 安全存储，多提供商支持       |
| 基础设置      | P1     | 主题切换、默认模型、温度     |
| Markdown 渲染 | P1     | 代码高亮、数学公式           |
| 消息操作      | P1     | 复制、重新生成、编辑         |
| 系统托盘      | P1     | 后台运行、快速唤起           |

### 开发计划

#### 第 1-2 周：项目基础

- [ ] 项目初始化（Vite + React + Electron）
- [ ] 基础 UI 框架（shadcn/ui）
- [ ] SQLite + Drizzle ORM 集成
- [ ] 状态管理（Zustand）
- [ ] IPC 通信层

#### 第 3-4 周：核心功能

- [ ] AI SDK 封装（OpenAI、Claude、Ollama）
- [ ] 流式响应处理
- [ ] 会话 CRUD
- [ ] 消息列表渲染
- [ ] API Key 安全存储

#### 第 5-6 周：完善体验

- [ ] Markdown 渲染（代码高亮）
- [ ] 设置页面
- [ ] 主题切换
- [ ] 消息操作（复制、重新生成）
- [ ] 系统托盘
- [ ] 打包测试

---

## v0.2.0 - 知识库

**目标：** 支持文档上传和 RAG 检索增强

**预计周期：** 4-6 周

### 功能范围

| 功能       | 描述                                                |
| ---------- | --------------------------------------------------- |
| 文档上传   | 支持 PDF、TXT、MD、DOCX 格式                        |
| 文档解析   | 文本提取和智能分块                                  |
| 向量嵌入   | 先复用云端 Provider（OpenAI-compatible embeddings） |
| 向量存储   | LanceDB（本地目录存储）                             |
| RAG 检索   | 相似度搜索和上下文增强                              |
| 知识库管理 | 创建、删除、文档管理 UI                             |

### 开发计划

- [ ] 文档上传组件
- [ ] 文档解析器（PDF、DOCX 等）
- [ ] 文本分块策略
- [ ] Embedding 模型集成（云端 Provider 优先）
- [ ] 向量数据库集成（LanceDB）
- [ ] 检索 API 实现
- [ ] RAG 流程集成
- [ ] 知识库管理 UI

---

## v0.3.0 - Agent 系统

**目标：** 支持工具调用和 Agent 能力

**预计周期：** 6-8 周

### 功能范围

| 功能         | 描述                          |
| ------------ | ----------------------------- |
| 工具调用框架 | Function Calling 支持         |
| 内置工具     | 网页搜索、URL 抓取、代码执行  |
| 插件系统     | 基础插件架构（含权限与隔离）  |
| MCP 协议     | Model Context Protocol 客户端 |
| Agent 运行时 | ReAct 模式执行引擎            |
| 插件 API     | 工具、UI、存储 API            |

### 开发计划

- [ ] 工具定义和注册机制
- [ ] 工具执行器
- [ ] 内置工具实现
- [ ] 插件加载器
- [ ] 插件沙箱
- [ ] 插件 API 实现
- [ ] MCP 客户端
- [ ] Agent 运行时

---

## v1.0.0 - 正式发布

**目标：** 功能完善、稳定可靠的正式版本

### 功能范围

| 功能     | 描述                   |
| -------- | ---------------------- |
| 插件市场 | 插件发现、安装、更新   |
| 助手系统 | 预设和自定义助手       |
| 多语言   | 国际化支持             |
| 性能优化 | 启动速度、内存占用优化 |

### 未来规划

- 移动端支持（React Native）
- 团队协作功能
- 企业版功能
- API 开放平台

---

## 技术栈版本

| 依赖           | 版本   | 说明         |
| -------------- | ------ | ------------ |
| Node.js        | 20 LTS | 长期支持版本 |
| pnpm           | 10.x   | 包管理器     |
| Electron       | 33.x   | 最新稳定版   |
| Vite           | 6.x    | 前端构建     |
| React          | 19.x   | 稳定版       |
| TypeScript     | 5.7+   | 最新特性     |
| Zustand        | 5.x    | 状态管理     |
| Drizzle ORM    | 0.30+  | 数据库 ORM   |
| better-sqlite3 | 11.x   | SQLite 驱动  |
| shadcn/ui      | latest | UI 组件      |
| Tailwind CSS   | 4.x    | 样式         |

---

## 里程碑检查点

### MVP 发布检查清单

- [ ] 核心功能完成
- [ ] 无阻塞性 Bug
- [ ] 基础文档完成
- [ ] macOS / Windows / Linux 打包测试
- [ ] 性能基准测试

### 正式发布检查清单

- [ ] 功能完整性验证
- [ ] 安全审计通过
- [ ] 性能优化完成
- [ ] 用户文档完成
- [ ] 更新检查机制
- [ ] 错误上报机制
