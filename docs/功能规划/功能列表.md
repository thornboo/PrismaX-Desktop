# 功能列表

> 本文档规划 PrismaX 的完整功能列表与优先级

---

## 功能优先级规划

### P0 - 核心功能（MVP）

必须在第一版实现的功能：

| 功能 | 说明 | 桌面版 | Web版 | 移动端 |
|------|------|--------|-------|--------|
| **基础对话** | 与 AI 模型对话 | Yes | Yes | Yes |
| **多模型支持** | OpenAI、Claude、本地模型等 | Yes | Yes | Yes |
| **Ollama 集成** | 本地模型支持 | Yes | Yes | - |
| **会话管理** | 创建、删除、重命名会话 | Yes | Yes | Yes |
| **消息管理** | 编辑、删除、重新生成 | Yes | Yes | Yes |
| **流式响应** | 实时显示 AI 回复 | Yes | Yes | Yes |
| **Markdown 渲染** | 代码高亮、表格、公式 | Yes | Yes | Yes |
| **模型配置** | API Key、端点配置 | Yes | Yes | Yes |
| **主题切换** | 亮色/暗色主题 | Yes | Yes | Yes |
| **多语言** | 中文/英文 | Yes | Yes | Yes |
| **用户认证** | 登录、注册 | - | Yes | Yes |
| **数据持久化** | 本地/服务端存储 | Yes | Yes | Yes |

### P1 - 重要功能

第二阶段实现的功能：

| 功能 | 说明 | 桌面版 | Web版 | 移动端 |
|------|------|--------|-------|--------|
| **知识库 RAG** | 文档上传、向量搜索、问答 | Yes | Yes | Yes |
| **文件上传** | 图片、PDF、文档 | Yes | Yes | Yes |
| **云同步** | 跨设备数据同步 | Yes | Yes | Yes |
| **助手预设** | 系统提示词模板 | Yes | Yes | Yes |
| **快捷键** | 常用操作快捷键 | Yes | Yes | - |
| **搜索功能** | 会话、消息搜索 | Yes | Yes | Yes |
| **数据导出** | 导出对话记录 | Yes | Yes | Yes |
| **���用户管理** | 用户管理、权限控制 | - | Yes | - |

### P2 - 增强功能

第三阶段实现的功能：

| 功能 | 说明 | 桌面版 | Web版 | 移动端 |
|------|------|--------|-------|--------|
| **Agent 系统** | 工具调用、自动化 | Yes | Yes | Yes |
| **MCP 协议** | 外部工具集成 | Yes | Yes | - |
| **插件系统** | 第三方插件 | Yes | Yes | - |
| **联网搜索** | Tavily/Brave 搜索 | Yes | Yes | Yes |
| **TTS/STT** | 语音输入输出 | Yes | Yes | Yes |
| **话题分支** | 对话分支管理 | Yes | Yes | Yes |
| **数据备份** | 自动备份、恢复 | Yes | Yes | Yes |
| **系统托盘** | 后台运行、快捷唤起 | Yes | - | - |
| **自动更新** | 应用自动更新 | Yes | - | Yes |

### P3 - 锦上添花

后续版本考虑的功能：

| 功能 | 说明 | 桌面版 | Web版 | 移动端 |
|------|------|--------|-------|--------|
| **助手市场** | 社区助手分享 | Yes | Yes | Yes |
| **插件市场** | 社区插件分享 | Yes | Yes | - |
| **多窗口** | 多会话窗口 | Yes | - | - |
| **团队协作** | 共享会话、知识库 | - | Yes | - |
| **API 服务** | 对外提供 API | - | Yes | - |
| **监控面板** | 使用统计、成本分析 | - | Yes | - |

---

## 功能详细设计

### 1. 基础对话功能

#### 1.1 会话管理

**功能点**：
- 自动按时间分组（今天、昨天、更早）
- 支持手动分类（文件夹）
- 支持搜索、筛选
- 支持批量操作（删除、移动）
- 支持置顶、收藏
- 自动生成会话标题

#### 1.2 消息交互

**功能点**：
- Markdown 完整渲染
  - 代码高亮（多语言支持）
  - 表格渲染
  - 数学公式（LaTeX）
  - Mermaid 图表
- 消息操作
  - 复制消息
  - 编辑消息
  - 删除消息
  - 重新生成
- 流式打字效果
- 代码块一键复制
- 图片预览、放大
- 长消息折叠

#### 1.3 输入增强

**功能点**：
- 多行输入（Shift+Enter 换行）
- 文件拖拽上传
- 粘贴图片
- @提及（切换模型、引用知识库）
- 快捷指令（/开头）
- 历史记录（上下箭头）

---

### 2. 多模型支持

#### 2.1 支持的模型提供商

| 提供商 | 模型 | 优先级 |
|--------|------|--------|
| **OpenAI** | GPT-4o, GPT-4, GPT-3.5 | P0 |
| **Anthropic** | Claude 3.5, Claude 3 | P0 |
| **Google** | Gemini Pro, Gemini Flash | P1 |
| **阿里云** | 通义千问 | P1 |
| **DeepSeek** | DeepSeek Chat, Coder | P1 |
| **Ollama** | Llama, Mistral, 等本地模型 | P0 |
| **OpenRouter** | 聚合多个模型 | P1 |
| **自定义** | OpenAI 兼容端点 | P0 |

#### 2.2 ��型配置

**功能点**：
- API Key 配置（加密存储）
- 自定义端点
- 模型参数配置（温度、最大 Token 等）
- 模型分组管理
- 快速切换模型

---

### 3. 知识库 RAG

#### 3.1 知识库管理

**功能点**：
- 创建/删除知识库
- 知识库描述
- 配置 Embedding 模型
- 配置分块参数

#### 3.2 文档管理

**支持的格式**：

| 格式 | 说明 | 优先级 |
|------|------|--------|
| Markdown | .md | P0 |
| 纯文本 | .txt | P0 |
| PDF | .pdf | P0 |
| Word | .docx | P1 |
| 网页 | URL 抓取 | P1 |
| 代码 | 各种编程语言 | P2 |

**功能点**：
- 文档上传（拖拽/选择）
- 文档预览
- 文档删除
- 处理状态显示
- 错误提示

#### 3.3 RAG 检索

**流程**：
```
用户提问 -> 问题向量化 -> 相似度搜索 -> 重排序 -> 上下文组装 -> AI 回答
```

**功能点**：
- 相似度搜索（Top-K）
- 重排序（Reranker）
- 上下文窗口控制
- 引用来源显示

---

### 4. 助手预设

#### 4.1 助手配置

**配置项**：
- 名称、描述、头像
- 默认模型
- 系统提示词
- 温度、最大 Token
- 关联知识库
- 可用工具

#### 4.2 预设助手

| 助手 | 用途 |
|------|------|
| 通用助手 | 日常对话 |
| 代码专家 | 编程辅助 |
| 写作助手 | 文案创作 |
| 翻译专家 | 多语言翻译 |
| 数据分析师 | 数据分析 |

---

### 5. 云同步功能

#### 5.1 同步范围

| 数据类型 | 是否同步 |
|----------|----------|
| 会话记录 | Yes |
| 助手配置 | Yes |
| 模型配置 | Yes |
| 知识库 | Yes |
| 应用设置 | Yes |

#### 5.2 同步策略

- **实时同步**：消息发送后立即同步
- **增量同步**：只同步变更的数据
- **冲突处理**：以最新修改为准
- **离线支持**：离线时本地存储，联网后自动同步

---

### 6. 快捷键

#### 6.1 全局快捷键（桌面版）

| 快捷键 | 功能 |
|--------|------|
| `Cmd/Ctrl + Shift + Space` | 唤起/隐藏窗口 |
| `Cmd/Ctrl + N` | 新建会话 |
| `Cmd/Ctrl + W` | 关闭当前会话 |
| `Cmd/Ctrl + ,` | 打开设置 |

#### 6.2 对话快捷键

| 快捷键 | 功能 |
|--------|------|
| `Enter` | 发送消息 |
| `Shift + Enter` | 换行 |
| `Cmd/Ctrl + Enter` | 发送并新建会话 |
| `Up Arrow` | 编辑上一条消息 |
| `Cmd/Ctrl + R` | 重新生成 |
| `Cmd/Ctrl + C` | 复制选中/最后回复 |
| `Cmd/Ctrl + K` | 快速切换模型 |
| `Escape` | 停止生成 |

---

## 已确认决策

| # | 决策项 | 结论 |
|---|--------|------|
| 1 | 云同步 | 需要 |
| 2 | 移动端 | 需要（后期） |
| 3 | Ollama 集成 | 需要 |
| 4 | UI 组件库 | shadcn/ui |
| 5 | 桌面框架 | Electron |

## 待确认功能

| # | 功能 | 问题 |
|---|------|------|
| 1 | 团队协作 | Web 版是否需要团队功能？ |
| 2 | 离线模式 | 桌面版离线时的功能范围？ |
| 3 | 付费功能 | 是否有商业化计划？ |
