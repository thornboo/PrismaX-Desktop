# 功能列表

> 本文档列出 PrismaX-Desktop 完整功能列表及优先级规划

---

## 功能优先级规划

### P0 - 核心功能 (MVP)

首版必须实现的功能：

| 功能              | 描述                       | 桌面端 |
| ----------------- | -------------------------- | ------ |
| **基础聊天**      | 与 AI 模型对话             | ✅     |
| **多模型支持**    | OpenAI、Claude、本地模型等 | ✅     |
| **Ollama 集成**   | 本地模型支持               | ✅     |
| **会话管理**      | 创建、删除、重命名会话     | ✅     |
| **消息管理**      | 编辑、删除、重新生成       | ✅     |
| **流式响应**      | 实时显示 AI 回复           | ✅     |
| **Markdown 渲染** | 代码高亮、表格、公式       | ✅     |
| **模型配置**      | API Key、端点配置          | ✅     |
| **主题切换**      | 明暗主题                   | ✅     |
| **多语言**        | 中英文                     | ✅     |
| **数据持久化**    | 本地存储                   | ✅     |

### P1 - 重要功能

第二阶段实现的功能：

| 功能           | 描述                     | 桌面端 |
| -------------- | ------------------------ | ------ |
| **知识库 RAG** | 文档上传、向量搜索、问答 | ✅     |
| **文件上传**   | 图片、PDF、文档          | ✅     |
| **助手预设**   | 系统提示词模板           | ✅     |
| **快捷键**     | 常用操作快捷键           | ✅     |
| **搜索功能**   | 会话、消息搜索           | ✅     |
| **数据导出**   | 导出对话记录             | ✅     |

### P2 - 增强功能

第三阶段实现的功能：

| 功能           | 描述               | 桌面端 |
| -------------- | ------------------ | ------ |
| **Agent 系统** | 工具调用、自动化   | ✅     |
| **MCP 协议**   | 外部工具集成       | ✅     |
| **插件系统**   | 第三方插件         | ✅     |
| **网页搜索**   | Tavily/Brave 搜索  | ✅     |
| **TTS/STT**    | 语音输入输出       | ✅     |
| **话题分支**   | 对话分支管理       | ✅     |
| **数据备份**   | 自动备份、恢复     | ✅     |
| **系统托盘**   | 后台运行、快速唤起 | ✅     |

### P3 - 锦上添花

未来版本考虑的功能：

| 功能         | 描述         | 桌面端 |
| ------------ | ------------ | ------ |
| **助手市场** | 社区助手分享 | ✅     |
| **插件市场** | 社区插件分享 | ✅     |
| **多窗口**   | 多个会话窗口 | ✅     |

---

## 详细功能设计

### 1. 基础聊天功能

#### 1.1 会话管理

**功能点**：

- 按时间自动分组（今天、昨天、更早）
- 手动分类（文件夹）
- 支持搜索和筛选
- 批量操作（删除、移动）
- 支持置顶和收藏
- 自动生成会话标题

#### 1.2 消息交互

**功能点**：

- 完整 Markdown 渲染
  - 代码高亮（多语言支持）
  - 表格渲染
  - 数学公式（LaTeX）
  - Mermaid 图表
- 消息操作
  - 复制消息
  - 编辑消息
  - 删除消息
  - 重新生成
- 流式打字效果
- 代码块一键复制
- 图片预览和缩放
- 长消息折叠

#### 1.3 输入增强

**功能点**：

- 多行输入（Shift+Enter 换行）
- 文件拖拽上传
- 粘贴图片
- @提及（切换模型、引用知识库）
- 快捷命令（以 / 开头）
- 历史记录导航（上下箭头）

---

### 2. 多模型支持

#### 2.1 支持的模型提供商

| 提供商         | 模型                      | 优先级 |
| -------------- | ------------------------- | ------ |
| **OpenAI**     | GPT-4o, GPT-4, GPT-3.5    | P0     |
| **Anthropic**  | Claude 3.5, Claude 3      | P0     |
| **Google**     | Gemini Pro, Gemini Flash  | P1     |
| **阿里云**     | 通义千问                  | P1     |
| **DeepSeek**   | DeepSeek Chat, Coder      | P1     |
| **Ollama**     | Llama, Mistral 等本地模型 | P0     |
| **OpenRouter** | 聚合多种模型              | P1     |
| **自定义**     | OpenAI 兼容端点           | P0     |

#### 2.2 模型配置

**功能点**：

- API Key 配置（加密存储）
- 自定义端点
- 模型参数配置（温度、最大 token 等）
- 模型分组管理
- 快速切换模型

---

### 3. 知识库 RAG

#### 3.1 知识库管理

**功能点**：

- 创建/删除知识库
- 知识库描述
- 配置 Embedding 模型
- 配置分块参数

#### 3.2 文档管理

**支持格式**：

| 格式     | 说明         | 优先级 |
| -------- | ------------ | ------ |
| Markdown | .md          | P0     |
| 纯文本   | .txt         | P0     |
| PDF      | .pdf         | P0     |
| Word     | .docx        | P1     |
| 网页     | URL 抓取     | P1     |
| 代码     | 各种编程语言 | P2     |

**功能点**：

- 文档上传（拖拽/选择）
- 文档预览
- 文档删除
- 处理状态显示
- 错误提示

#### 3.3 RAG 检索

**流程**：

```
用户问题 -> 问题向量化 -> 相似度搜索 -> 重排序 -> 上下文组装 -> AI 回答
```

**功能点**：

- 相似度搜索（Top-K）
- 重排序（Reranker）
- 上下文窗口控制
- 来源引用显示

当前落地说明（实现进度）：

- 全文检索：SQLite FTS5（chunks_fts）
- 向量存储：LanceDB（本地目录 `index/vector/lancedb/`）
- 向量化：先复用已配置的云端 Provider（OpenAI-compatible embeddings），API Key 不落盘

---

### 4. 助手预设

#### 4.1 助手配置

**配置项**：

- 名称、描述、头像
- 默认模型
- 系统提示词
- 温度、最大 token
- 关联知识库
- 可用工具

#### 4.2 预设助手

| 助手       | 用途       |
| ---------- | ---------- |
| 通用助手   | 日常对话   |
| 代码专家   | 编程辅助   |
| 写作助手   | 内容创作   |
| 翻译专家   | 多语言翻译 |
| 数据分析师 | 数据分析   |

---

### 5. 快捷键

#### 5.1 全局快捷键

| 快捷键                     | 功能          |
| -------------------------- | ------------- |
| `Cmd/Ctrl + Shift + Space` | 显示/隐藏窗口 |
| `Cmd/Ctrl + N`             | 新建会话      |
| `Cmd/Ctrl + W`             | 关闭当前会话  |
| `Cmd/Ctrl + ,`             | 打开设置      |

#### 5.2 聊天快捷键

| 快捷键             | 功能              |
| ------------------ | ----------------- |
| `Enter`            | 发送消息          |
| `Shift + Enter`    | 换行              |
| `Cmd/Ctrl + Enter` | 发送并新建会话    |
| `↑`                | 编辑上一条消息    |
| `Cmd/Ctrl + R`     | 重新生成          |
| `Cmd/Ctrl + C`     | 复制选中/最后回复 |
| `Cmd/Ctrl + K`     | 快速切换模型      |
| `Escape`           | 停止生成          |
